---
layout: post
title: 一类逻辑推理谜题的深入思考
description: ""
category: 其他
tags: [puzzle]
---
{% include JB/setup %}

* toc
{:toc}

<br />

**更新中 未完成**

我相信不少人都见过如下这类所谓的“IQ测试题”：

问题1：

	有6个不同国籍的人，他们的名字分别是为ABCDEF，他们的国籍分别是美国，德国，英国，法国，俄罗斯和意大利（名字顺序与国籍不一定一致）现已知：
	1. A和美国人是医生
	2. E和俄罗斯人是教师
	3. C和德国人是技师
	4. B和F曾经当过兵而德国人没有当过
	5. 法国人比A年龄大 意大利人比C年龄小
	6. B和美国人下周要去英国旅行，C同法国人下周要到瑞士去度假
	请判断ABCDEF分别是哪个国家人

问题2：
	
	甲、乙、丙、丁四人的国籍分别为英国、俄国、法国、日本。乙比甲高，丙最矮；英国人比俄国人高，法国人最高；日本人比丁高。这四个人的国籍是什么？

问题3：

	有五栋五种颜色的房子,每一位房子的主人国籍都不同:
	1. 英国人住在红房子里
	2. 瑞典人养了一条狗
	3. 丹麦人喝茶
	4. 绿房子在白房子左边且相邻
	5. 绿房子主人喝咖啡
	6. 抽PALL MALL烟的人养了一只鸟
	7. 黄房子主人抽DUNHILL烟
	8. 住在中间那间房子的人喝牛奶
	9. 挪威人住在第一间房子
	10. 抽混合烟的人住在养猫人的旁边
	11. 养马人住在DUNHILL烟的人旁边
	12. 抽BLUE MASTER烟的人喝啤酒
	13. 德国人抽PRINCE烟
	14. 挪威人住在蓝房子旁边
	15. 抽混合烟的人的邻居喝矿泉水
	问题是: 谁养鱼？

<hr />

这类问题是否反映IQ以及IQ是否重要我们且不去讨论，我们只对这类问题本身感兴趣。这类问题好像给了一堆乱麻一样的条件，然后问一个看似“无厘头”的问题。
一般而言，这类问题是有一个唯一或者少数的解，通常借助纸笔逐条分析是能够解出来的，无非是复杂程度的不同。

但更加令我感兴趣的不是这类问题的其中某一个，而是这类问题背后更一般化的问题，或者说，有三个问题：

* 这类问题的一般化的描述
* 有没有一种形式化的通用的解法
* 如何去构造任意的这种问题（题干不矛盾并且有唯一或者少数的几个解）

本篇就是试图深入的分析下这类问题，回答下上面提到的三个问题。

## 一般化描述
我们先来直观的看下上面两个问题的“模式”：有某种事或者物，它有至少两种标签。通过给出标签之间关系，要求我们尽可能多的推导出每个事或者物所具有的集合标签。

在第一个问题中，描述的主题是人，人有ABCDEF编号与国籍两个标签。所谓A与美国人是医生指的是A不是美国人且职业是医生，美国人也是医生；E和俄罗斯人是教师指的是E不是俄罗斯人、俄罗斯人也是教师，E是教师，结合前面也可以断定E不是美国人。描述的虽然花里胡哨，但是给出的信息就是某个编号下不是哪国人。
要求我们确定编号与国籍直接的对应关系。

在第二个问题中，描述的主题是人，人有身高、编号（甲乙丙丁）、国籍三个标签。其中身高是个全排序关系。“乙比甲高，丙最矮”描述了标签在身高下的排序关系。“英国人比俄国人高，法国人最高”描述了国籍在身高下的部分排序关系。“日本人比丁高”则设计标号与国籍两个标签在身高这个可排序标签下的关系。题目要求我们确定编号、国籍、身高直接的对应关系。

在第三个问题中，描述的主题是房子，房子有主人，主人有特征或爱好，我们可以把特征或爱好也看出房子的标签。因此有房子有编号（从左到有1到5）、颜色、国籍、宠物、香烟、饮料6种标签。其中序号是可全排序的。题目要求我们确定编号、颜色、国籍、宠物、香烟、饮料直接的对应关系。

可以看到，本质上这是一类标签问题。虽然到这里，我们的一般化描述还不够形式化，但是对于我们后面的分析，已经足够了。

## 上面三个问题的解法
从标签数量看，上面三个问题逐渐复杂。

解法的基本思路就是给每个事物的列出所有可能的标签，然后应用条件去排除。

### 解问题1

问题1只有两个标签，是比较简单的。

初始状态，A可能是任意国籍，其余类似。标签集合如下：
```
-: 美 俄 德 法 英 意
A: o  o  o  o  o  o
B: o  o  o  o  o  o
C: o  o  o  o  o  o
D: o  o  o  o  o  o
E: o  o  o  o  o  o
F: o  o  o  o  o  o
```
根据题目中条件，排除后标签集合如下：
```
-: 美 俄 德 法 英 意
A: x  x  x  x  o  o   
B: x  o  x  x  o  o   
C: x  x  x  x  o  x   
D: o  o  o  o  o  o   
E: x  x  x  o  o  o   
F: o  o  x  o  o  o   
```

排出后可以发现C只能是英国人。C确定了之后又可以排除其他编号下是英国人的可能，随后可以确定A是意大利人；以此类推，整个问题就可以解开了。
可以看到，问题非常简单。

### 解问题2
问题2有三个标签，基本思路是先确定两个标签之间的对应关系。至于一般的问题中先确定哪两个标签直接的关系，是要根据题目中那种标签给出的信息最多来判断的。

这个问题先确定编号与身高或者国籍与身高都是一样的。

初始状态：
```
 身高编号从1到4,1最高
--: 1 2 3 4
甲: o o o o
乙: o o o o
丙: o o o o
丁: o o o o
```
根据条件排除后：
```
 身高编号从1到4,1最高
--: 1 2 3 4
甲: x o o o
乙: o o o x
丙: x x x o
丁: x x o o
```
这里需要注意丁的排除逻辑：日本人比丁高，法国人最高，这意味着法、日都比丁高。法国人最高这个条件看似与编号与身高的关系无关，但通过日本人比丁高这个条件与之发生关联，日本人比丁高排除了丁最高的可能，也就排除了丁是法国人的可能，因此法、日都比丁高。

经过上面的排除后，可以看到问题与问题一样了。可以依次确定丙、丁、甲、乙的身高编号。

同理再确定国籍与身高编号直接的关系，于是`编号、身高、国籍`的三元组对应关系就出来了。

### 解问题3

问题3有6种标签，虽然基本思路是一样的，但是最难的地方是找到先确定哪两种标签之间的关系，这个只能一个个的去尝试，没什么其他好办法。

我们直接给出答案：先确定编号与颜色的对应关系。


挪威人住在第一间房子且住在蓝房子旁边，因此第二间是蓝色。

绿房子主人喝咖啡，而中间房子主人喝牛奶，因此绿房子不是3号。绿白相邻因此绿房子也不是1号（2号蓝色），因此只能是绿房子是4号白房子5号。

挪威人住第一间且隔壁是蓝房子。而英国人住红房子。因此第一间肯定不是红房子，因此红房子只能是第3间（2,4,5都已经确定颜色），因此黄房子第一间。

那我们确定了编号与颜色的关系：
```
1: 黄 
2: 蓝
3: 红
4: 绿
5: 白
```

第一步：根据上面的条件1、5、7、8、9可以直接确定一些标签：
```
  颜色      国籍     动物       香烟     饮料 
1: 黄       挪威              DunHill
2: 蓝								
3: 红       英                         牛奶
4: 绿                                  咖啡
5: 白
```

第二步：养马人住在抽DunHill烟的人旁边，1号只有一个邻居，因此2号养马。

```
  颜色     国籍     动物       香烟     饮料 
1: 黄      挪威              DunHill
2: 蓝               马				
3: 红      英                         牛奶
4: 绿                                 咖啡
5: 白
```

第三步：抽BlueMaster烟的喝啤酒，因此1号房主人肯定不喝啤酒。丹麦人喝茶，因此1号房主人也不喝茶，1号房主人只能是喝矿泉水的。
抽混合烟的人的邻居喝矿泉水，因此2号房抽混合烟。

```
  颜色     国籍     动物       香烟     饮料 
1: 黄      挪威              DunHill  矿泉水
2: 蓝               马       混合烟		
3: 红      英                         牛奶
4: 绿                                 咖啡
5: 白
```

第四步：抽BLUE MASTER烟的人喝啤酒，德国人抽Price烟，因此德国人肯定不喝啤酒。
丹麦人喝茶，英国人喝牛奶，挪威人喝矿泉水，那德国人只能喝咖啡。因此绿房子主人是德国人。
与德国人相关的标签也确定了：德国人抽prince烟。
```
  颜色     国籍     动物       香烟     饮料 
1: 黄      挪威              DunHill  矿泉水
2: 蓝               马       混合烟		
3: 红      英                         牛奶
4: 绿      德                prince   咖啡
5: 白
```

第五步：蓝房子主人养马，瑞典人养狗。因此蓝房子肯定不是瑞典人。瑞典人只能是白房子。丹麦人蓝房子。
同时也确定了2号主人喝茶，5号主人养狗。

```
  颜色     国籍     动物       香烟     饮料 
1: 黄      挪威              DunHill  矿泉水
2: 蓝      丹麦     马       混合烟   茶
3: 红      英                         牛奶
4: 绿      德                prince   咖啡
5: 白      瑞典     狗
```

第六步：至此，编号与国籍的对应关系就全出来了。紧接着，啤酒只能是瑞典人喝了。编号与饮料的对应关系也明了了。
喝啤酒的抽BLUE MASTER烟，那3号房主人只能抽Pall Mall烟了。编号与烟的关系也确定了。

```
  颜色     国籍     动物       香烟     饮料 
1: 黄      挪威              DunHill  矿泉水
2: 蓝      丹麦     马       混合烟   茶	
3: 红      英                Pall     牛奶
4: 绿      德                prince   咖啡
5: 白      瑞典     狗       Blue     啤酒
```
第七步：抽PallMall的养了只鸟，3号房养鸟。抽混合烟（2号房）的住在养猫人旁边，1号房只能养猫。

```
  颜色     国籍     动物       香烟     饮料 
1: 黄      挪威     猫       DunHill  矿泉水
2: 蓝      丹麦     马       混合烟   茶	
3: 红      英       鸟       Pall     牛奶
4: 绿      德                prince   咖啡
5: 白      瑞典     狗       Blue     啤酒
```

因此如果有人养鱼，只能是德国人。

这道题复杂在只有最后才能确定编号与宠物的关系。一个至关重要的限制是每种标签只属于一个房子或房主。这是二、三、四、五步排除法的关键。

## 通用解法

一个推理机一样的存在，我还没有找到足够漂亮的解法。

### 标签集合

### 可排序标签

这类问题中有一类特殊标签就是可排序标签：问题2中的身高，问题3中房子的左右顺序。
这类标签的判断逻辑并不是是否的问题，而是出现范围排除，比如大于小于关系。真假二元标签需要通过枚举来进行范围排除。

### 算法实现

## 任意构造



